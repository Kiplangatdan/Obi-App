{"version":3,"sources":["../../src/pages/checkout/checkout.module.ts","../../src/pages/checkout/checkout.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CheckoutPage } from './checkout';\n\n@NgModule({\n  declarations: [\n    CheckoutPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CheckoutPage),\n  ],\n})\nexport class CheckoutPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/checkout/checkout.module.ts","import { Component, ViewChild, ElementRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ViewController, ToastController, Slides } from 'ionic-angular';\nimport { WooProvider } from '../../providers/woo/woo';\nimport { Storage } from '@ionic/storage';\nimport { StripeService, Elements, Element as StripeElement, ElementsOptions } from \"ngx-stripe\";\n\n/**\n * Generated class for the CheckoutPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-checkout',\n  templateUrl: 'checkout.html',\n})\nexport class CheckoutPage {\n\n\t@ViewChild(Slides) slides: Slides;\n\n\torder: any = {\n\t\tbilling: Object\n\t}\n\tspinner: any\n\tcart_contents: any\n\tgateways: any\n\tshipping_methods: any\n\tisLastSlide: boolean = false\n\tbilling_shipping_same: boolean = true\n\telements: Elements;\n  \tcard: StripeElement;\n  \tshipping_zones: any;\n  \tstripe_selected: boolean = false\n  \tgateway_instructions: string = ''\n  \tcart_total: number;\n  \tshipping_cost: number = 0;\n\n\t@ViewChild('card') cardRef: ElementRef;\n\t// optional parameters\n\telementsOptions: ElementsOptions = {\n\t\tlocale: 'en'\n\t};\n\n\tconstructor(\n\t\tpublic navCtrl: NavController, \n\t\tpublic navParams: NavParams,\n\t\tpublic wooProvider: WooProvider,\n\t\tpublic loadingCtrl: LoadingController,\n\t\tpublic viewCtrl: ViewController,\n\t\tpublic storage: Storage,\n\t\tpublic toastCtrl: ToastController,\n\t\tprivate stripeService: StripeService\n\t\t) {\n\n\t\tthis.storage.get( 'cart' ).then( data => {\n\n\t\t\tif( !data )\n\t\t\t\tthis.presentToast( 'No cart items.' );\n\n\t\t\t// console.log('cart', data)\n\n\t\t\tthis.cart_contents = data\n\n\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\tlet total = parseInt( data[i].price ) * parseInt( data[i].quantity )\n\t\t\t\tthis.cart_total = ( this.cart_total ? this.cart_total : 0 ) + total\n\t\t\t}\n\n\t\t})\n\n\t}\n\n\tionViewDidLoad() {\n\t\tthis.loadStripe()\n\t\tthis.getGateways()\n\t\tthis.getShippingZones()\n\t}\n\n\tgetGateways() {\n\n\t\tthis.wooProvider.get( '/wp-json/wc/v2/payment_gateways', null ).then( response => {\n\t\t\t// console.log(response)\n\t\t\tthis.gateways = []\n\t\t\tfor (var i = 0; i < (<any>response).length; ++i) {\n\t\t\t\tif( response[i].enabled ) {\n\t\t\t\t\tthis.gateways.push( response[i] )\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t}\n\n\t// first we need to get the zones, which have all the data we need\n\tgetShippingZones() {\n\n\t\tthis.wooProvider.get( '/wp-json/wc/v2/shipping/zones', null ).then( response => {\n\t\t\t// console.log(response)\n\t\t\tthis.shipping_zones = response\n\t\t})\n\n\t}\n\n\t// once a zone is selected, we get the methods from that zone\n\tzoneChange( zone_id ) {\n\n\t\tif( zone_id ) {\n\t\t\tthis.getShippingMethods( zone_id )\n\t\t}\n\t}\n\n\t// get methods from a specific zone, which has cost data\n\tgetShippingMethods( id ) {\n\n\t\tthis.wooProvider.get( '/wp-json/wc/v2/shipping/zones/' + id + '/methods', 'nopaging' ).then( response => {\n\t\t\t// console.log(response)\n\t\t\tthis.shipping_methods = response\n\t\t})\n\n\t}\n\n\tgatewaySelected( gateway ) {\n\n\t\t// console.log(gateway, this.gateways)\n\n\t\tif( gateway === 'stripe' ) {\n\t\t\tthis.stripe_selected = true\n\t\t} else {\n\t\t\tthis.stripe_selected = false\n\t\t}\n\n\t\tfor (var i = 0; i < this.gateways.length; ++i) {\n\n\t\t\tif( gateway === this.gateways[i].id ) {\n\t\t\t\tthis.gateway_instructions = this.gateways[i].description\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tthis.gateway_instructions = ''\n\t\t\t}\n\t\t}\n\n\t}\n\n\tloadStripe() {\n\n\t\tthis.stripeService.elements( this.elementsOptions )\n\t      .subscribe(elements => {\n\t        this.elements = elements;\n\t        // Only mount the element the first time\n\t        if (!this.card) {\n\t        \tconsole.log('creating card')\n\t          this.card = this.elements.create('card', {\n\t            style: {\n\t              base: {\n\t                iconColor: '#666EE8',\n\t                color: '#31325F',\n\t                lineHeight: '40px',\n\t                fontWeight: 300,\n\t                fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n\t                fontSize: '18px',\n\t                '::placeholder': {\n\t                  color: '#CFD7E0'\n\t                }\n\t              }\n\t            }\n\t          });\n\t          this.card.mount('#card-element');\n\t        }\n\t      });\n\t}\n\n\tsubmit() {}\n\n\tdoCheckout( data ) {\n\n\t\t// console.log(data.value)\n\t\tlet order = data.value\n\t\t\n\t\tif( !order ) {\n\t\t\tthis.presentToast( 'No order data submitted.' );\n\t\t\treturn;\n\t\t}\n\n\t\tif( !this.cart_contents ) {\n\t\t\tthis.presentToast( 'No cart items.' );\n\t\t\treturn;\n\t\t}\n\n\t\tif( !order.billing.first_name || !order.billing.postcode || !order.payment_method ) {\n\t\t\tthis.presentToast( 'Please fill out all required fields.' );\n\t\t\tthis.slides.slideTo(0)\n\t\t\treturn;\n\t\t}\n\n\t\tif( order.billing.billing_shipping_same === false ) {\n\t\t\t// fill shipping address\n\t\t} else {\n\t\t\torder.shipping = order.billing\n\t\t}\n\n\t\tif( order.shipping_lines && order.shipping_lines.method_id ) {\n\n\t\t\tlet split = order.shipping_lines.method_id.split(\"::\")\n\t\t\torder.shipping_lines.method_id = split[0]\n\t\t\torder.shipping_lines.method_title = split[1]\n\t\t\torder.shipping_lines.total = split[2]\n\n\t\t}\n\n\t\torder.shipping_lines = [order.shipping_lines]\n\n\t\t// console.log(order.shipping_lines)\n\n\t\torder.line_items = []\n\n\t\tfor (var i = 0; i < this.cart_contents.length; ++i) {\n\t\t\torder.line_items[i] = {\n\t\t\t\tproduct_id: this.cart_contents[i].product_id,\n\t\t\t\tvariation_id: this.cart_contents[i].variation_id,\n\t\t\t\tquantity: parseInt( this.cart_contents[i].quantity )\n\t\t\t}\n\t\t}\n\n\t\tthis.showSpinner()\n\n\t\tthis.wooProvider.send( order, 'wp-json/wc/v2/orders' ).then( response => {\n\n\t\t\tif( !(<any>response).id ) {\n\t\t\t\t// console.log(response)\n\t\t\t\tthis.hideSpinner()\n\t\t\t\tthis.presentToast( 'There was a problem processing your order, please try again.' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif( order.payment_method === 'stripe' ) {\n\t\t\t\tthis.stripePayment((<any>response).id, this.card, order.billing.first_name)\n\t\t\t}\n\n\t\t}, (err) => {\n\n\t\tthis.hideSpinner()\n\t\tconsole.log(err)\n\n\t\t}).catch( e => {\n\t\t\tconsole.warn(e)\n\t\t\tthis.hideSpinner()\n\t\t\tthis.presentToast( 'There was a problem connecting to the server.' );\n\t\t})\n\n\t\t// make sure spinner disappears even if there's a problem\n\t\tsetTimeout( () => {\n\t\t\tthis.hideSpinner();\n\t\t}, 5000 );\n\n\t}\n\n\tstripePayment( order_id, card, name ) {\n\n\t\t// console.log('stripe payment', order_id, card, name)\n\n\t\tthis.stripeService\n\t      .createToken(card, { name })\n\t      .subscribe(result => {\n\t        if (result.token) {\n\t          // Use the token to create a charge or a customer\n\t          // https://stripe.com/docs/charges\n\t          this.sendToken( result.token.id, order_id )\n\t        } else if (result.error) {\n\t          // Error creating the token\n\t          console.log(result.error.message);\n\t        }\n\t      });\n\n\t}\n\n\tsendToken( token, order_id ) {\n\n\t\tlet data = {\n\t\t\torder_id: order_id,\n\t\t\tpayment_token: token,\n\t\t\tpayment_method: 'stripe'\n\t\t}\n\n\t\t// console.log('send token', data)\n\n\t\tthis.wooProvider.send( data, 'wp-json/wc/v2/stripe-payment' ).then( response => {\n\n\t\t\t// console.log(response)\n\n\t\t\tthis.presentToast( 'Thank you for your order!' );\n\n\t\t\tthis.storage.remove( 'cart' )\n\n\t\t\tlet opt = {};\n\n\t\t\tthis.navCtrl.push('ThanksPage', {\n\t\t\t  order_id: order_id\n\t\t\t}, opt);\n\n\t\t\tthis.dismiss()\n\n\t\t}, (err) => {\n\n\t\tthis.hideSpinner()\n\t\tconsole.log(err)\n\n\t\t}).catch( e => {\n\t\t\tconsole.warn(e)\n\t\t\tthis.hideSpinner()\n\t\t\tthis.presentToast( 'There was a problem connecting to the server.' );\n\t\t})\n\n\t}\n\n\tshippingCost( e ) {\n\t\tconsole.log(e)\n\t\tif( e.indexOf('::') >= 0 ) {\n\n\t\t\tlet split = e.split(\"::\")\n\t\t\tthis.shipping_cost = parseInt( split[2] )\n\n\t\t}\n\t}\n\n\tdismiss() {\n\t\tthis.viewCtrl.dismiss();\n\t}\n\n\tshowSpinner() {\n\t\tthis.spinner = this.loadingCtrl.create();\n\n\t\tthis.spinner.present();\n\t}\n\n\thideSpinner() {\n\t\tthis.spinner.dismiss();\n\t}\n\n\tpresentToast(msg) {\n\n\t    let toast = this.toastCtrl.create({\n\t      message: msg,\n\t      duration: 5000,\n\t      position: 'bottom'\n\t    });\n\n\t    toast.present();\n\n\t}\n\n\tnextSlide() {\n\t\tthis.slides.slideNext()\n\t}\n\n\tprevSlide() {\n\t\tthis.slides.slidePrev()\n\t}\n\n\tslideChanged() {\n\n\t\tif( this.slides.isEnd() ) {\n\t\t\tthis.isLastSlide = true\n\t\t} else {\n\t\t\tthis.isLastSlide = false\n\t\t}\n\t}\n\n\tbillingShippingToggle(e) {\n\t\tthis.billing_shipping_same = e.checked\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/checkout/checkout.ts"],"sourceRoot":""}